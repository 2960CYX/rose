# 技术实现文档

本项目为「区块链理念博客系统」的前端演示，实现“创作即版权”的体验，并提供探索、搜索、归档、作者目录、资源中心、路线图、标签与专题等内容页。以下文档说明项目架构、关键模块与实现细节，便于后续维护与扩展。

## 概览

- 技术栈：`Vue 3` + `Vite` + `Element Plus` + `Pinia` + `Vue Router`
- 数据持久化：浏览器 `localStorage`
- 主题与样式：统一使用全局变量（如 `--radius-card`、`--color-muted`）保证风格一致
- 运行方式：`npm install`、`npm run dev`，默认在 `http://localhost:5173/` 或 `5174`

## 项目结构

关键目录及文件（仅列核心）：

- `src/main.js`：应用入口，注册 `router`、`pinia`、`ElementPlus`
- `src/App.vue`：应用外壳，统一布局与主内容区域
- `src/router/index.js`：路由配置与（如有）路由守卫，注册页面入口
- `src/stores/`：Pinia 仓库（`user.js`、`post.js`）
- `src/components/`：通用组件（如 `PostCard.vue`、`AppHeader.vue`）
- `src/pages/`：页面模块（`Archive.vue`、`Authors.vue`、`Resources.vue`、`Roadmap.vue`、`Tags.vue`、`Series.vue`、`Explore.vue`、`Learn.vue`、`Search.vue`、`Profile.vue`、`Auth.vue`、`About.vue`、`NotFound.vue` 等）
- `style.css`：全局样式与主题变量（位于项目根 `src` 下）

## 路由与导航

- 路由注册文件：`src/router/index.js`
- 已注册页面路径：
  - 内容拓展：`/archives`（归档）、`/authors`（作者）、`/resources`（资源）、`/roadmap`（路线图）、`/tags`（标签）、`/series`（专题）
  - 功能页面：`/explore`（探索）、`/learn`（学习）、`/search`（搜索）、`/profile`（个人中心）、`/auth`（登录/注册）
  - 其他：`/about`、`*` → `NotFound`
- 路由守卫（如存在）：通过 `meta.requiresAuth` 与 `useUserStore().isAuthenticated` 判断访问权限，未登录用户跳转到 `/auth`
- 顶部导航（`src/components/AppHeader.vue`）：
  - 主导航 + 「更多」子菜单：集中入口减少拥挤
  - 新增入口：`标签`、`专题`，对应 `/tags`、`/series`

## 状态管理（Pinia）

### 用户仓库：`src/stores/user.js`

- 状态字段：
  - `users`：用户列表（本地持久化）
  - `currentUserId`：当前用户 ID（本地持久化）
  - `connectedWallet`：当前连接的模拟钱包地址（本地持久化）
- 主要动作：
  - `register(username, password)`：注册用户并生成钱包地址
  - `login(username, password)`：登录并设置 `currentUserId`
  - `logout()`：清空当前登录态与钱包连接
  - `connectWallet(address)` / `disconnectWallet()`：连接/断开模拟钱包
  - `guestLogin()`：一键体验（假登录）。复用或创建“Guest”账号，设置 `currentUserId` 与 `connectedWallet`
- 计算属性：
  - `currentUser`：当前用户对象（含 `username`、`walletAddress`）
  - `isAuthenticated`：是否已登录

### 文章仓库：`src/stores/post.js`

- 职责：文章列表管理、点赞与评论、按作者/标签检索、默认种子扩充与合并
- 数据结构（示例）：
  - `postList`: 数组，含 `id`、`title`、`summary`、`content`、`authorId`、`authorName`、`likes`、`comments`、`createdAt` 等
- 初始化逻辑：
  - 默认文章种子（不少于 7 篇），首次加载时与本地存储数据合并，避免覆盖用户已有内容
- 典型动作：
  - `createPost(payload)`：发布文章并记录时间戳与作者信息
  - `toggleLike(postId)`：点赞/取消点赞
  - `addComment(postId, comment)`：添加评论
  - `postsByAuthor(authorId)`：按作者聚合文章

## 页面实现要点

- `Archive.vue`：
  - 按年月分组展示文章（`YYYY-MM` → `YYYY年MM月`），使用 `PostCard` 渲染列表
  - 依赖 `usePostStore().postList`
- `Authors.vue`：
  - 统计作者文章数、总点赞、总评论；支持一键检索该作者文章（跳转 `/search?q=<name>`）
  - 使用 `el-table` 进行表格展示
- `Resources.vue`：
  - 文档与教程、社区与讨论、创作与版权工具、工具与脚手架、学习路线建议
  - 使用 `el-card` 卡片与自定义列表样式
- `Roadmap.vue`：
  - 计划（时间线）、里程碑（时间线）、待选特性（列表）
  - 统一卡片样式与列表风格
- `Tags.vue`：
  - 展示预定义标签；点击后跳转到 `/search?q=<tag>` 实现主题检索
- `Series.vue`：
  - 展示专题分组与建议路径，作为内容聚合入口
- `Search.vue`：
  - 支持深链接：读取路由参数 `q` 并预填搜索框（如来自作者页或标签页）
  - 命中范围：标题、摘要、正文、作者名
- `Auth.vue`：
  - 登录、注册表单，支持「一键体验（假登录）」按钮（调用 `guestLogin`）
- `Profile.vue`：
  - 展示用户信息与钱包地址复制按钮，列出作者文章
  - 支持退出登录并返回首页
- `PostCard.vue`：
  - 文章卡片通用视图；展示标题、摘要、作者、发布时间、点赞/评论数；点击进入详情

## 搜索与深链接

- 入口：`/search`
- 读取 `q` 参数：`watch(() => route.query.q)`，修改输入框并实时过滤
- 触发方式：
  - 作者页“检索TA的文章”按钮：`/search?q=<authorName>`
  - 标签页点击某标签：`/search?q=<tag>`

## 主题与样式

- 统一变量：`--radius-card`、`--color-muted` 等（见全局样式）
- 卡片与布局：多数页面采用 `el-card`，统一圆角与间距，形成一致的阅读体验
- 响应式建议：优先使用栅格/弹性布局（`grid`/`flex`），保证在不同宽度下的可读性

## 数据持久化

- 用户、登录态与钱包连接信息持久化至 `localStorage`
- 文章数据：初始种子与用户新增内容均持久化，且在初始化时进行合并以避免覆盖
- 注意：浏览器清理可能导致数据丢失，重要内容建议外部同步与备份

## 假登录实现（一键体验）

- 动作：`userStore.guestLogin()`
- 行为：
  - 若已存在 `Guest` 用户，则复用该用户并重新设置登录态与钱包连接
  - 若不存在，则创建并持久化一个带模拟钱包地址的 `Guest` 用户
  - 登录成功后可访问受限页面（如 `Profile`），与真实用户体验一致
- 入口：`/auth` 页面底部按钮「一键体验（假登录）」

## 构建与运行

```bash
npm install
npm run dev
# 本地预览： http://localhost:5173/ （端口占用时自动切换为 5174）
```

## 代码风格与维护建议

- 保持组件与页面的职责单一；通用块抽取至 `components/`
- 新增内容页时：在 `src/pages` 创建页面 → 注册路由 → 在 `AppHeader` 的「更多」中添加入口
- 若引入新状态：使用 Pinia 仓库并明确持久化策略（避免过度持久化）
- 变更后优先进行本地预览与基本交互验证（导航/路由、搜索深链接、登录态）

## 后续扩展建议

- 作者详情页：头像、简介、合集与徽章展示
- 文章编辑与版本管理：草稿、发布、审计日志
- 搜索优化：命中高亮、过滤器与排序规则
- 暗黑模式与主题切换：结合已有样式变量实现无缝切换
- 导出与备份：支持 Markdown/JSON 导出与链上校验机制

---

如需新增专题、标签分组或扩展默认文章种子，请在 `src/pages/Series.vue`、`src/pages/Tags.vue` 与 `src/stores/post.js` 中按上述约定进行更新，并同步在路由与导航注册入口。